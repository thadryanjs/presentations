set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 4)
{
p1 <- rnorm(1000, 1, 1)
p2 <- rnorm(1000, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 4)
{
p1 <- rnorm(1000, 1, 1)
p2 <- rnorm(1000, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 2) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 4)
{
p1 <- rnorm(1000, 1, 1)
p2 <- rnorm(1000, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 5) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 4)
{
p1 <- rnorm(1000, 1, 1)
p2 <- rnorm(1000, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 4)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 1) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 2) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 2) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100*sampleFactor
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 2) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100*sampleFactor
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 1) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100*sampleFactor
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
ns <- seq(5, 100, 1)
cs <- c()
for(i in 1:length(ns)) {
cs[i] <- ( qnorm(0.25) * ((1)/(sqrt(ns[i]))))
}
plot(cs, ns)
ns <- seq(5, 100, 1)
cs <- c()
for(i in 1:length(ns)) {
cs[i] <- 1-( qnorm(0.25) * (1)/(sqrt(ns[i])) )
}
plot(cs, ns)
ns <- seq(5, 100, 1)
cs <- c()
for(i in 1:length(ns)) {
cs[i] <- (-1* qnorm(0.25) * (1)/(sqrt(ns[i])) )
}
plot(cs, ns)
ns <- seq(5, 100, 1)
cs <- c()
for(i in 1:length(ns)) {
cs[i] <- (-1* qnorm(0.25) * (1)/(sqrt(ns[i])) )
}
plot(ns,cs)
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100*sampleFactor
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 3) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 5) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
set.seed(8675309)
options(scipen = 999)
sim5 <- function(sampleFactor = 1)
{
n1 <- 1000
p1 <- rnorm(n1, 1, 1)
p2 <- rnorm(3*n1, 1, 1*sampleFactor)
mus1 <- c()
mus2 <- c()
n1SampleSize <- 100
n2SampleSize <- 100*sampleFactor
for(i in 1:1000) {
mus1[i] <- sample(p1, n1SampleSize, replace = FALSE) %>% mean()
mus2[i] <- sample(p2, n2SampleSize, replace = FALSE) %>% mean()
}
data.frame(mu1 = mus1, mu2 = mus2)
}
sim5(sampleFactor = 1) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 2) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 3) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 4) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
sim5(sampleFactor = 5) %>%
ggplot(.) +
geom_density(aes(mu1), color = "red") +
geom_density(aes(mu2), color = "blue")
((1.94-1)/1.94)*(67/(67+31))*100
(1.94-1)/1.94
((1.94-1)/1.94)*(67/(67+31))*100
(1.94-1)/1.94)
(67*126)/(31*140)
(1.94-1)/1.94
((1.94-1)/1.94)*(67/(67+31))*100
(67*126)/(31*140)
(1.95-1)/1.95
((1.95-1)/1.95)*(67/(67+31))*100
325/(263+588)
325*(263+588)
325*(+588)
325/(588)
325/(588)*100
325/(588)*100
(650-300)/(650)
325/(588)*100
((650-300)/(650))*100
mean(dCell$mean[1]))
mean(dCell$mean[1])
library(multtest)
library(dplyr)
library(ggplot2)
data(golub)
gene1.values <- golub[1, ]
gene1.values %>% mean
var(gene1.values)
yeast.counts <- data.frame(
cells = 0:12,
concen.1 = c(213,128,37,18,3,1,0,0,0,0,0,0,0),
concen.2 = c(103,143,98,42,8,4,2,0,0,0,0,0,0),
concen.3 = c(75,103,121,54,30,13,2,1,0,1,0,0,0),
concen.4 = c(0,20,43,53,86,70,54,37,18,10,5,2,2)
)
yeast.counts
theoreticalSE <- function(v)
{
sqrt( (mean(v)/length(v)) )
}
is <- c()
means <- c()
ses <- c()
for(i in 2:ncol(yeast.counts)) {
cellAdjusted <- yeast.counts$cells * yeast.counts[, i]
mean <- cellAdjusted %>% mean
theoSE <- cellAdjusted %>% theoreticalSE()
is[i] <- i
means[i] <- mean
ses[i] <- theoSE
}
(dCell <- data.frame(i = is, mean = means, theoSE = ses))
yeastMean <- function(colName)
{
yeast.counts$cells * yeast.counts[, colName]
}
yeastMean("concen.1") %>% mean
mean(dCell$mean[1])
mean(dCell$mean[2])
set.seed(8675309)
sim2 <- function()
{
rpois(nrow(yeast.counts), lambda = mean(dCell$mean[2])) %>% theoreticalSE()
}
dSim2 <- data.frame(se = unlist(replicate(10000, sim2())))
seMean <- dSim2 %>%
pull(se) %>%
mean %>%
round(4)
dSim2 %>%
ggplot(aes(se)) +
geom_histogram(fill = "#00693e", color = "black") +
ggtitle(paste("Mean SE: ", seMean)) +
theme_minimal() +
geom_vline(xintercept = seMean, color = "purple", size = 1)
set.seed(8675309)
sim2 <- function()
{
rpois(nrow(yeast.counts), lambda = mean(dCell$mean[3])) %>% theoreticalSE()
}
dSim2 <- data.frame(se = unlist(replicate(10000, sim2())))
seMean <- dSim2 %>%
pull(se) %>%
mean %>%
round(4)
dSim2 %>%
ggplot(aes(se)) +
geom_histogram(fill = "#00693e", color = "black") +
ggtitle(paste("Mean SE: ", seMean)) +
theme_minimal() +
geom_vline(xintercept = seMean, color = "purple", size = 1)
set.seed(8675309)
sim2 <- function()
{
rpois(nrow(yeast.counts), lambda = mean(dCell$mean[4])) %>% theoreticalSE()
}
dSim2 <- data.frame(se = unlist(replicate(10000, sim2())))
seMean <- dSim2 %>%
pull(se) %>%
mean %>%
round(4)
dSim2 %>%
ggplot(aes(se)) +
geom_histogram(fill = "#00693e", color = "black") +
ggtitle(paste("Mean SE: ", seMean)) +
theme_minimal() +
geom_vline(xintercept = seMean, color = "purple", size = 1)
set.seed(8675309)
sim2 <- function()
{
rpois(nrow(yeast.counts), lambda = mean(dCell$mean[5])) %>% theoreticalSE()
}
dSim2 <- data.frame(se = unlist(replicate(10000, sim2())))
seMean <- dSim2 %>%
pull(se) %>%
mean %>%
round(4)
dSim2 %>%
ggplot(aes(se)) +
geom_histogram(fill = "#00693e", color = "black") +
ggtitle(paste("Mean SE: ", seMean)) +
theme_minimal() +
geom_vline(xintercept = seMean, color = "purple", size = 1)
set.seed(8675309)
sim2 <- function()
{
rpois(nrow(yeast.counts), lambda = mean(dCell$mean[2])) %>% theoreticalSE()
}
dSim2 <- data.frame(se = unlist(replicate(10000, sim2())))
seMean <- dSim2 %>%
pull(se) %>%
mean %>%
round(4)
dSim2 %>%
ggplot(aes(se)) +
geom_histogram(fill = "#00693e", color = "black") +
ggtitle(paste("Mean SE: ", seMean)) +
theme_minimal() +
geom_vline(xintercept = seMean, color = "purple", size = 1)
mean(gene1.values) - 1.96*(sqrt(var(gene1.values)/length(gene1.values)))
library(multtest)
library(dplyr)
library(ggplot2)
data(golub)
gene1.values <- golub[1, ]
gene1.values %>% mean
var(gene1.values)
mean(gene1.values) - 1.96*(sqrt(var(gene1.values)/length(gene1.values)))
mean(gene1.values)
mean(gene1.values) + 1.96*(sqrt(var(gene1.values)/length(gene1.values)))
# this can'y be right
var(gene1.values) + mean(gene1.values)^2
setwd("~/Workspace/Presentations/JournalClub1Epi")
